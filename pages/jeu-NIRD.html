<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NIRD Manager - Sauvez le lyc√©e !</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .game-container {
            max-width: 900px;
            width: 100%;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .game-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            display: flex;
            flex-direction: row;
            justify-content: space-around;
            align-items: center;
        }

        .game-header-btn input{
            background-color: transparent!important;
            color: white!important;
            border: 2px solid white!important;
            border-radius: 4px;
            padding: 2%;
            font-size: 2rem;
            font-weight: bold;
        }

        .game-header-btn input:hover{
            background-color: white!important;
            color: #667eea!important;
            cursor: pointer;
        }

        .game-header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .game-header p {
            opacity: 0.9;
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            padding: 20px;
            background: #f8f9fa;
        }

        .stat-box {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .stat-label {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .stat-bar {
            width: 100%;
            height: 12px;
            background: #e0e0e0;
            border-radius: 6px;
            overflow: hidden;
        }

        .stat-fill {
            height: 100%;
            transition: width 0.5s ease, background 0.3s ease;
        }

        .budget-fill {
            background: linear-gradient(90deg, #4CAF50, #45a049);
        }

        .co2-fill {
            background: linear-gradient(90deg, #ff6b6b, #ee5a52);
        }

        .resistance-fill {
            background: linear-gradient(90deg, #667eea, #764ba2);
        }

        .mission-container {
            padding: 30px;
        }

        .turn-info {
            text-align: center;
            margin-bottom: 20px;
            padding: 10px;
            background: #f0f0f0;
            border-radius: 8px;
        }

        .mission-image {
            width: 100%;
            height: 200px;
            background: linear-gradient(135deg, #667eea33 0%, #764ba233 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 5rem;
            margin-bottom: 20px;
        }

        .mission-title {
            font-size: 1.8rem;
            color: #333;
            margin-bottom: 15px;
            text-align: center;
        }

        .mission-text {
            font-size: 1.1rem;
            line-height: 1.6;
            color: #555;
            margin-bottom: 25px;
            padding: 15px;
            background: #f9f9f9;
            border-left: 4px solid #667eea;
            border-radius: 5px;
        }

        .choices-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .choice-button {
            background: white;
            border: 2px solid #667eea;
            padding: 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .choice-button:hover {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .choice-button:hover .choice-impacts {
            color: white;
        }

        .choice-text {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .choice-impacts {
            font-size: 0.9rem;
            color: #666;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .impact {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .impact.positive {
            color: #4CAF50;
        }

        .impact.negative {
            color: #f44336;
        }

        .feedback-container {
            padding: 20px;
            background: #f8f9fa;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .feedback-message {
            font-size: 1.1rem;
            text-align: center;
            padding: 15px;
            border-radius: 8px;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .feedback-message.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .feedback-message.warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .feedback-message.danger {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .game-over {
            text-align: center;
            padding: 40px;
        }

        .game-over h2 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: #667eea;
        }

        .game-over p {
            font-size: 1.2rem;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .restart-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .restart-button:hover {
            transform: scale(1.05);
        }

        .achievements {
            margin-top: 20px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 10px;
        }

        .achievement {
            padding: 10px;
            margin: 10px 0;
            background: white;
            border-radius: 5px;
            border-left: 4px solid #4CAF50;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .game-header h1 {
                font-size: 1.5rem;
            }

            .mission-title {
                font-size: 1.4rem;
            }

            .choice-button {
                padding: 15px;
            }
        }
    </style>
</head>

<body>
    <div class="game-container">
        <div class="game-header">
            <section>
                <h1>üéÆ NIRD Manager</h1>
                <p>Sauvez votre lyc√©e de l'Empire num√©rique !</p>
            </section>
            <section class="game-header-btn">
                <form action="../index.html">
                    <input type="submit" value="Retour au menu" />
                </form>
            </section>
        </div>

        <div class="stats-container">
            <div class="stat-box">
                <div class="stat-label">üí∞ Budget</div>
                <div class="stat-value" id="budget-value">10 000 ‚Ç¨</div>
                <div class="stat-bar">
                    <div class="stat-fill budget-fill" id="budget-bar" style="width: 100%"></div>
                </div>
            </div>

            <div class="stat-box">
                <div class="stat-label">üåç Impact CO2</div>
                <div class="stat-value" id="co2-value">0 kg</div>
                <div class="stat-bar">
                    <div class="stat-fill co2-fill" id="co2-bar" style="width: 0%"></div>
                </div>
            </div>

            <div class="stat-box">
                <div class="stat-label">‚úä R√©sistance</div>
                <div class="stat-value" id="resistance-value">50%</div>
                <div class="stat-bar">
                    <div class="stat-fill resistance-fill" id="resistance-bar" style="width: 50%"></div>
                </div>
            </div>
        </div>

        <div id="game-content">
            <div class="mission-container">
                <div class="turn-info">
                    <strong>Tour <span id="current-turn">1</span> / <span id="total-turns">12</span></strong>
                </div>

                <div class="mission-image" id="mission-image">üè´</div>

                <h2 class="mission-title" id="mission-title">Chargement...</h2>

                <div class="mission-text" id="mission-text">
                    Pr√©parez-vous √† g√©rer votre lyc√©e...
                </div>

                <div class="choices-container" id="choices-container">
                    <!-- Les choix seront g√©n√©r√©s ici -->
                </div>
            </div>

            <div class="feedback-container">
                <div class="feedback-message" id="feedback-message">
                    Bienvenue ! Faites vos choix avec sagesse...
                </div>
            </div>
        </div>
    </div>

    <script>
        // ========== CONFIGURATION DU JEU ==========
        const GAME_CONFIG = {
            initialBudget: 10000,
            maxBudget: 15000,
            maxCO2: 5000,
            totalTurns: 12,
            initialResistance: 50
        };

        // ========== √âTAT DU JEU ==========
        let gameState = {
            budget: GAME_CONFIG.initialBudget,
            co2: 0,
            resistance: GAME_CONFIG.initialResistance,
            currentTurn: 1,
            currentMissionIndex: 0,
            gameOver: false,
            achievements: []
        };

        // ========== MISSIONS ==========
        const missions = [
            {
                id: 1,
                titre: "üñ•Ô∏è La Fin de Windows 10",
                emoji: "üíª",
                texte: "Windows 10 n'est plus support√© par Microsoft. Les 50 PC de la salle B12 sont consid√©r√©s comme obsol√®tes, mais le mat√©riel fonctionne encore parfaitement. Que d√©cidez-vous ?",
                choix: [
                    {
                        texte: "Tout racheter en neuf avec Windows 11",
                        budget: -5000,
                        co2: 500,
                        resistance: -20,
                        message: "Les PC sont rapides mais le budget a fondu ! Et quelle empreinte carbone..."
                    },
                    {
                        texte: "Installer Linux (Ubuntu/PrimTux)",
                        budget: -200,
                        co2: 0,
                        resistance: 30,
                        message: "Excellent choix ! Les PC tournent √† merveille et les √©l√®ves adorent. Le village NIRD grandit ! üéâ"
                    },
                    {
                        texte: "Ne rien faire et esp√©rer",
                        budget: 0,
                        co2: 0,
                        resistance: -10,
                        message: "Les PC deviennent vuln√©rables sans mises √† jour. Ce n'est pas une bonne strat√©gie..."
                    }
                ]
            },
            {
                id: 2,
                titre: "‚òÅÔ∏è Le Stockage des Donn√©es",
                emoji: "üíæ",
                texte: "Les profs veulent partager des documents. Un commercial propose une solution Cloud h√©berg√©e aux USA, gratuite la premi√®re ann√©e. L'alternative ? Un serveur local.",
                choix: [
                    {
                        texte: "Accepter le Cloud am√©ricain (gratuit !)",
                        budget: 0,
                        co2: 150,
                        resistance: -40,
                        message: "Pratique, mais vos donn√©es sont maintenant hors UE... Et cette facture l'ann√©e prochaine ! üí∏"
                    },
                    {
                        texte: "Installer Nextcloud sur un vieux PC",
                        budget: -150,
                        co2: 10,
                        resistance: 40,
                        message: "Bravo ! Donn√©es souveraines, contr√¥le total. Les profs sont conquis ! üõ°Ô∏è"
                    }
                ]
            },
            {
                id: 3,
                titre: "üì± Les Tablettes de la R√©gion",
                emoji: "üì±",
                texte: "La r√©gion propose de donner 100 tablettes neuves √† tous les √©l√®ves, mais elles sont verrouill√©es avec un syst√®me propri√©taire. C'est tentant...",
                choix: [
                    {
                        texte: "Accepter toutes les tablettes",
                        budget: 0,
                        co2: 1000,
                        resistance: -15,
                        message: "Les √©l√®ves sont contents, mais quelle catastrophe √©cologique ! Et impossible de personnaliser..."
                    },
                    {
                        texte: "Refuser et am√©liorer la salle info",
                        budget: -500,
                        co2: 50,
                        resistance: 20,
                        message: "Un choix courageux ! La salle informatique est maintenant un mod√®le. üåü"
                    },
                    {
                        texte: "N√©gocier des tablettes reconditionn√©es libres",
                        budget: -300,
                        co2: 100,
                        resistance: 35,
                        message: "Le meilleur des deux mondes ! Tablettes pour tous, √©colo et libre ! üéØ"
                    }
                ]
            },
            {
                id: 4,
                titre: "üìß La Suite Bureautique",
                emoji: "üìÑ",
                texte: "Les licences Microsoft Office expirent. 800‚Ç¨ par an pour les renouveler. Que faire ?",
                choix: [
                    {
                        texte: "Renouveler les licences Microsoft",
                        budget: -800,
                        co2: 50,
                        resistance: -15,
                        message: "Facile mais co√ªteux. Chaque ann√©e, la m√™me facture..."
                    },
                    {
                        texte: "Passer √† LibreOffice",
                        budget: 0,
                        co2: 0,
                        resistance: 30,
                        message: "Gratuit, compatible et libre ! Formation en 2h et c'est parti ! üöÄ"
                    },
                    {
                        texte: "Utiliser des outils en ligne collaboratifs libres",
                        budget: -100,
                        co2: 20,
                        resistance: 25,
                        message: "OnlyOffice + Nextcloud = travail collaboratif sans GAFAM ! üëè"
                    }
                ]
            },
            {
                id: 5,
                titre: "üéì Formation des Profs",
                emoji: "üë®‚Äçüè´",
                texte: "Les enseignants sont perdus avec tous ces changements. Certains r√©clament une formation, d'autres r√©sistent. Budget formation disponible ?",
                choix: [
                    {
                        texte: "Former tout le monde au libre",
                        budget: -600,
                        co2: 0,
                        resistance: 40,
                        message: "Investissement payant ! Les profs deviennent autonomes et ambassadeurs du libre ! üéñÔ∏è"
                    },
                    {
                        texte: "Formation minimale (les volontaires)",
                        budget: -200,
                        co2: 0,
                        resistance: 15,
                        message: "Un bon d√©but, mais certains restent sur la touche..."
                    },
                    {
                        texte: "Pas de formation (on se d√©brouille)",
                        budget: 0,
                        co2: 0,
                        resistance: -20,
                        message: "Mauvaise id√©e... Frustration montante et retour en arri√®re possible ! ‚ö†Ô∏è"
                    }
                ]
            },
            {
                id: 6,
                titre: "üîí S√©curit√© et Mots de Passe",
                emoji: "üîê",
                texte: "Un audit r√©v√®le que 60% des mots de passe sont '123456'. Il faut agir ! Une solution ?",
                choix: [
                    {
                        texte: "Acheter un gestionnaire commercial",
                        budget: -400,
                        co2: 30,
                        resistance: -10,
                        message: "Efficace mais d√©pendant. Et ces donn√©es stock√©es o√π exactement ? ü§î"
                    },
                    {
                        texte: "D√©ployer KeePass/Bitwarden",
                        budget: -50,
                        co2: 5,
                        resistance: 30,
                        message: "Open source, h√©berg√© localement. S√©curit√© ET souverainet√© ! üîí"
                    },
                    {
                        texte: "Campagne de sensibilisation seulement",
                        budget: -100,
                        co2: 0,
                        resistance: 10,
                        message: "Un bon d√©but, mais insuffisant sans outils..."
                    }
                ]
            },
            {
                id: 7,
                titre: "üéÆ Club Informatique",
                emoji: "üèÜ",
                texte: "Des √©l√®ves passionn√©s veulent cr√©er un club Linux. Ils pourraient m√™me aider √† reconditionner les vieux PC ! Budget n√©cessaire pour le mat√©riel et l'encadrement.",
                choix: [
                    {
                        texte: "Financer g√©n√©reusement le club",
                        budget: -400,
                        co2: 0,
                        resistance: 45,
                        message: "Le club devient une p√©pini√®re de talents ! Ils r√©parent, forment et inspirent ! üåü"
                    },
                    {
                        texte: "Budget minimal (d√©brouillardise)",
                        budget: -150,
                        co2: 0,
                        resistance: 25,
                        message: "√áa fonctionne mais ils pourraient faire tellement plus..."
                    },
                    {
                        texte: "Refuser (pas le budget)",
                        budget: 0,
                        co2: 0,
                        resistance: -15,
                        message: "Les √©l√®ves sont d√©√ßus. Occasion manqu√©e de cr√©er une communaut√©... üòî"
                    }
                ]
            },
            {
                id: 8,
                titre: "üìä Visioconf√©rence",
                emoji: "üìπ",
                texte: "Post-Covid, les visios sont devenues essentielles. Zoom facture 2000‚Ç¨/an. Alternatives ?",
                choix: [
                    {
                        texte: "Rester sur Zoom",
                        budget: -2000,
                        co2: 100,
                        resistance: -25,
                        message: "Pratique mais cher. Et vos conversations transitent par les USA... üá∫üá∏"
                    },
                    {
                        texte: "D√©ployer Jitsi Meet en local",
                        budget: -300,
                        co2: 20,
                        resistance: 40,
                        message: "100% souverain, gratuit et performant ! Les profs valident ! üé•"
                    },
                    {
                        texte: "Utiliser BigBlueButton (Forge)",
                        budget: -200,
                        co2: 15,
                        resistance: 45,
                        message: "Parfait pour l'√©ducation ! H√©berg√© par le minist√®re, p√©dagogique ! üéì"
                    }
                ]
            },
            {
                id: 9,
                titre: "‚ôªÔ∏è Don de Mat√©riel",
                emoji: "üéÅ",
                texte: "Une entreprise locale ferme et propose de donner 30 PC de 5 ans. Gratuits mais √† reconditionner.",
                choix: [
                    {
                        texte: "Accepter et reconditionner avec Linux",
                        budget: -400,
                        co2: -200,
                        resistance: 35,
                        message: "√âconomie circulaire ! Le club les retape, ils repartent pour 5 ans ! ‚ôªÔ∏è"
                    },
                    {
                        texte: "Refuser (trop vieux)",
                        budget: 0,
                        co2: 300,
                        resistance: -10,
                        message: "30 PC √† la d√©charge... Quel g√¢chis. L'entreprise est d√©√ßue. üóëÔ∏è"
                    }
                ]
            },
            {
                id: 10,
                titre: "üåê Connexion Internet",
                emoji: "üì°",
                texte: "Le FAI actuel co√ªte cher. Une box 4G ferait l'affaire et co√ªterait 40% moins cher, mais moins stable.",
                choix: [
                    {
                        texte: "Garder la fibre premium",
                        budget: -1200,
                        co2: 50,
                        resistance: 0,
                        message: "Stable et rapide. Mais cher pour ce que c'est..."
                    },
                    {
                        texte: "Passer en 4G √©conomique",
                        budget: -700,
                        co2: 30,
                        resistance: 5,
                        message: "√âconomie r√©alis√©e ! Quelques ralentissements mais g√©rable. üì∂"
                    },
                    {
                        texte: "N√©gocier avec le FAI un tarif √©ducation",
                        budget: -900,
                        co2: 40,
                        resistance: 10,
                        message: "Belle n√©gociation ! Compromis id√©al qualit√©/prix. ü§ù"
                    }
                ]
            },
            {
                id: 11,
                titre: "üìö Manuels Num√©riques",
                emoji: "üìñ",
                texte: "Les √©diteurs proposent des manuels num√©riques : 15‚Ç¨/√©l√®ve/an. Alternative : ressources libres.",
                choix: [
                    {
                        texte: "Acheter les manuels num√©riques",
                        budget: -3000,
                        co2: 50,
                        resistance: -20,
                        message: "Pratique mais abonnement √©ternel. DRM et d√©pendance... üìï"
                    },
                    {
                        texte: "Utiliser Wikiversit√© + ressources libres",
                        budget: 0,
                        co2: 0,
                        resistance: 40,
                        message: "Gratuit, libre, collaboratif ! Les profs contribuent m√™me ! üìö"
                    },
                    {
                        texte: "Hybride : mix manuel papier + libre",
                        budget: -1000,
                        co2: 100,
                        resistance: 15,
                        message: "Compromis acceptable. Tout le monde y trouve son compte. ‚öñÔ∏è"
                    }
                ]
            },
            {
                id: 12,
                titre: "üèÅ Bilan de l'Ann√©e",
                emoji: "üéØ",
                texte: "L'ann√©e touche √† sa fin. Le rectorat √©value votre gestion. Votre bilan final d√©terminera l'avenir du lyc√©e...",
                choix: [
                    {
                        texte: "Pr√©senter les r√©sultats",
                        budget: 0,
                        co2: 0,
                        resistance: 0,
                        message: "C'est l'heure du verdict..."
                    }
                ]
            }
        ];

        // ========== FONCTIONS D'AFFICHAGE ==========
        function updateStats() {
            // Budget
            document.getElementById('budget-value').textContent = `${gameState.budget.toLocaleString()} ‚Ç¨`;
            const budgetPercent = Math.max(0, Math.min(100, (gameState.budget / GAME_CONFIG.maxBudget) * 100));
            document.getElementById('budget-bar').style.width = budgetPercent + '%';

            // CO2
            document.getElementById('co2-value').textContent = `${gameState.co2} kg`;
            const co2Percent = Math.min(100, (gameState.co2 / GAME_CONFIG.maxCO2) * 100);
            document.getElementById('co2-bar').style.width = co2Percent + '%';

            // R√©sistance
            document.getElementById('resistance-value').textContent = `${gameState.resistance}%`;
            const resistancePercent = Math.max(0, Math.min(100, gameState.resistance));
            document.getElementById('resistance-bar').style.width = resistancePercent + '%';

            // Tour
            document.getElementById('current-turn').textContent = gameState.currentTurn;
        }

        function displayMission() {
            const mission = missions[gameState.currentMissionIndex];

            document.getElementById('mission-image').textContent = mission.emoji;
            document.getElementById('mission-title').textContent = mission.titre;
            document.getElementById('mission-text').textContent = mission.texte;

            const choicesContainer = document.getElementById('choices-container');
            choicesContainer.innerHTML = '';

            mission.choix.forEach((choix, index) => {
                const button = document.createElement('button');
                button.className = 'choice-button';

                let impactsHTML = '<div class="choice-impacts">';
                if (choix.budget !== 0) {
                    const budgetClass = choix.budget > 0 ? 'positive' : 'negative';
                    impactsHTML += `<span class="impact ${budgetClass}">üí∞ ${choix.budget > 0 ? '+' : ''}${choix.budget}‚Ç¨</span>`;
                }
                if (choix.co2 !== 0) {
                    const co2Class = choix.co2 > 0 ? 'negative' : 'positive';
                    impactsHTML += `<span class="impact ${co2Class}">üåç ${choix.co2 > 0 ? '+' : ''}${choix.co2}kg CO2</span>`;
                }
                if (choix.resistance !== 0) {
                    const resClass = choix.resistance > 0 ? 'positive' : 'negative';
                    impactsHTML += `<span class="impact ${resClass}">‚úä ${choix.resistance > 0 ? '+' : ''}${choix.resistance}%</span>`;
                }
                impactsHTML += '</div>';

                button.innerHTML = `
                    <div class="choice-text">${choix.texte}</div>
                    ${impactsHTML}
                `;

                button.onclick = () => makeChoice(index);
                choicesContainer.appendChild(button);
            });
        }

        function makeChoice(choiceIndex) {
            const mission = missions[gameState.currentMissionIndex];
            const choix = mission.choix[choiceIndex];

            // Appliquer les cons√©quences
            gameState.budget += choix.budget;
            gameState.co2 += choix.co2;
            gameState.resistance += choix.resistance;

            // Limiter les valeurs
            gameState.resistance = Math.max(0, Math.min(100, gameState.resistance));
            gameState.co2 = Math.max(0, gameState.co2);

            // Mettre √† jour l'affichage
            updateStats();

            // Afficher le feedback
            showFeedback(choix.message);

            // V√©rifier les conditions de game over
            setTimeout(() => {
                if (checkGameOver()) {
                    return;
                }

                // Passer au tour suivant
                gameState.currentTurn++;
                gameState.currentMissionIndex++;

                if (gameState.currentMissionIndex >= missions.length) {
                    endGame('victory');
                } else {
                    displayMission();
                    showFeedback('Prochaine mission...', 'success');
                }
            }, 3000);
        }

        function showFeedback(message, type = 'success') {
            const feedbackEl = document.getElementById('feedback-message');
            feedbackEl.textContent = message;
            feedbackEl.className = 'feedback-message ' + type;
        }

        function checkGameOver() {
            if (gameState.budget <= 0) {
                endGame('bankruptcy');
                return true;
            }
            if (gameState.co2 >= GAME_CONFIG.maxCO2) {
                endGame('climate');
                return true;
            }
            if (gameState.resistance <= 0) {
                endGame('assimilation');
                return true;
            }
            return false;
        }

        function endGame(reason) {
            gameState.gameOver = true;

            let title, message, emoji;
            const achievements = calculateAchievements();

            switch (reason) {
                case 'victory':
                    emoji = 'üéâ';
                    title = 'Victoire ! Ann√©e R√©ussie !';
                    message = `Bravo ! Vous avez termin√© l'ann√©e scolaire avec brio !<br><br>
                        <strong>Statistiques finales :</strong><br>
                        üí∞ Budget restant : ${gameState.budget}‚Ç¨<br>
                        üåç CO2 √©mis : ${gameState.co2}kg<br>
                        ‚úä R√©sistance : ${gameState.resistance}%<br><br>
                        ${getVictoryMessage()}`;
                    break;
                case 'bankruptcy':
                    emoji = 'üí∏';
                    title = 'Faillite !';
                    message = 'Le lyc√©e est en faillite... Les d√©penses ont √©t√© trop importantes. Le rectorat reprend la main.';
                    break;
                case 'climate':
                    emoji = 'üå°Ô∏è';
                    title = 'Catastrophe Climatique !';
                    message = 'L\'empreinte carbone du lyc√©e est devenue insoutenable. La plan√®te ne peut plus suivre...';
                    break;
                case 'assimilation':
                    emoji = 'üè¢';
                    title = 'Assimil√© par l\'Empire !';
                    message = 'Le lyc√©e a perdu toute ind√©pendance. Vous √™tes maintenant totalement d√©pendant des Big Tech...';
                    break;
            }

            const gameContent = document.getElementById('game-content');
            gameContent.innerHTML = `
                <div class="game-over">
                    <div style="font-size: 5rem; margin-bottom: 20px;">${emoji}</div>
                    <h2>${title}</h2>
                    <p>${message}</p>
                    ${achievements.length > 0 ? `
                        <div class="achievements">
                            <h3>üèÜ Succ√®s D√©bloqu√©s</h3>
                            ${achievements.map(a => `<div class="achievement">${a.emoji} ${a.name}: ${a.description}</div>`).join('')}
                        </div>
                    ` : ''}
                    <button class="restart-button" onclick="restartGame()">üîÑ Recommencer</button>
                </div>
            `;
        }

        function getVictoryMessage() {
            if (gameState.resistance >= 80 && gameState.budget >= 5000 && gameState.co2 < 1000) {
                return 'üåü <strong>Victoire Parfaite !</strong> Vous √™tes un mod√®le pour tous les √©tablissements NIRD !';
            } else if (gameState.resistance >= 70) {
                return 'üí™ <strong>Village R√©sistant !</strong> Votre lyc√©e est un exemple d\'ind√©pendance num√©rique !';
            } else if (gameState.budget >= 7000) {
                return 'üí∞ <strong>Gestionnaire Prudent !</strong> Vous avez su pr√©server les finances tout en innovant !';
            } else if (gameState.co2 < 1500) {
                return 'üå± <strong>H√©ros √âcologique !</strong> Votre empreinte carbone est exemplaire !';
            } else {
                return '‚úÖ Vous avez r√©ussi √† maintenir l\'√©quilibre. Continuez sur cette voie !';
            }
        }

        function calculateAchievements() {
            const achievements = [];

            if (gameState.resistance >= 100) {
                achievements.push({
                    emoji: 'üõ°Ô∏è',
                    name: 'H√©ros du Libre',
                    description: 'Atteindre 100% de r√©sistance'
                });
            }

            if (gameState.budget >= GAME_CONFIG.initialBudget) {
                achievements.push({
                    emoji: 'üêøÔ∏è',
                    name: 'L\'√âcureuil',
                    description: 'Finir avec plus d\'argent qu\'au d√©but'
                });
            }

            if (gameState.co2 < 500) {
                achievements.push({
                    emoji: 'üåç',
                    name: 'Sauveur de la Plan√®te',
                    description: 'Maintenir l\'empreinte CO2 sous 500kg'
                });
            }

            if (gameState.resistance >= 80 && gameState.co2 < 1000) {
                achievements.push({
                    emoji: '‚öñÔ∏è',
                    name: '√âquilibre Parfait',
                    description: 'Alliance de r√©sistance et d\'√©cologie'
                });
            }

            if (gameState.budget >= 8000 && gameState.resistance >= 70) {
                achievements.push({
                    emoji: 'üíé',
                    name: 'Gestion Exemplaire',
                    description: 'Budget √©lev√© et forte r√©sistance'
                });
            }

            return achievements;
        }

        function restartGame() {
            gameState = {
                budget: GAME_CONFIG.initialBudget,
                co2: 0,
                resistance: GAME_CONFIG.initialResistance,
                currentTurn: 1,
                currentMissionIndex: 0,
                gameOver: false,
                achievements: []
            };

            document.getElementById('game-content').innerHTML = `
                <div class="mission-container">
                    <div class="turn-info">
                        <strong>Tour <span id="current-turn">1</span> / <span id="total-turns">12</span></strong>
                    </div>
                    <div class="mission-image" id="mission-image">üè´</div>
                    <h2 class="mission-title" id="mission-title">Chargement...</h2>
                    <div class="mission-text" id="mission-text">
                        Pr√©parez-vous √† g√©rer votre lyc√©e...
                    </div>
                    <div class="choices-container" id="choices-container">
                    </div>
                </div>
                <div class="feedback-container">
                    <div class="feedback-message" id="feedback-message">
                        Bienvenue ! Faites vos choix avec sagesse...
                    </div>
                </div>
            `;

            updateStats();
            displayMission();
        }

        // ========== D√âMARRAGE DU JEU ==========
        window.onload = function () {
            updateStats();
            displayMission();
        };
    </script>
</body>

</html>